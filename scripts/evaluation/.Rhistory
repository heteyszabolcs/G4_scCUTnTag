y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 1),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.1),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = 1),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = -1),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = -0.1),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = 0),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = 00.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.7, hjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0, hjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 1, hjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggplot(meta,
aes(x = seurat_clusters,
y = predicted.seurat_clusters.score,
fill = predicted.seurat_clusters)) +
geom_boxplot() +
scale_fill_manual(values = c("#addd8e", "#bcbcbc")) +
ylim(0.5, 1) +
labs(
title = "",
x = "Seurat cluster (GFP+)",
y = "prediction score",
fill = "predicted \nunsorted cluster"
) +
theme_minimal() +
theme(
text = element_text(size = 10),
plot.title = element_text(size = 10),
axis.title.y = element_text(size = 20, color = "black"),
axis.title.x = element_text(size = 20, color = "black"),
axis.text.x = element_text(size = 20, color = "black", angle = 45, vjust = 0.75, hjust = 0.5),
axis.text.y = element_text(size = 20, color = "black")
) +
stat_compare_means(label.y = 1, label = "p.signif")
ggsave(
glue("{result_folder}MapQuery-sorted_to_unsorted-predscore_distr.pdf"),
plot = last_plot(),
device = "pdf",
width = 7,
height = 6
)
DefaultAssay(sorted) = "GA"
DefaultAssay(unsorted) = "GA"
sorted@meta.data$data_type = "sorted G4 scCnT"
sorted@meta.data = sorted@meta.data %>%
mutate(custom_col = "sorted clusters")
unsorted@meta.data$data_type = "unsorted G4 scCnT"
unsorted@meta.data = unsorted@meta.data %>% mutate(
seurat_clusters =
case_when(
seurat_clusters == "0" ~ "cluster 0 (unsorted)",
seurat_clusters == "1" ~ "cluster 1 (unsorted)"
)
) %>%
mutate(custom_col = seurat_clusters)
unsorted = FindVariableFeatures(unsorted, selection.method = "vst", nfeatures = 2000)
genes.use = VariableFeatures(unsorted)
coembed = merge(x = sorted, y = unsorted)
coembed = ScaleData(coembed, features = genes.use, do.scale = FALSE)
coembed = RunPCA(coembed, features = genes.use, verbose = FALSE)
coembed = RunUMAP(coembed, dims = 1:5)
cols = c("cluster 0 (unsorted)" = "#fc9272", "cluster 1 (unsorted)" = "#9ecae1",
"sorted clusters" = "#31a354")
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
)
# xlim(-5, 8) +
# ylim(-5, 5)
coembed_cells
ggsave(
glue("{result_folder}merged-sorted_unsorted.pdf"),
plot = coembed_cells,
device = "pdf",
width = 7,
height = 6
)
coembed_cells
coembed@meta.data
seurat_clusters
x = unsorted@meta.data
View(x)
x = coembed@meta.data
View(x)
cols = c("cluster 0 (unsorted)" = "#fc9272", "cluster 1 (unsorted)" = "#9ecae1",
"sorted clusters" = "#31a354")
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
)
# xlim(-5, 8) +
# ylim(-5, 5)
coembed_cells
unsorted
xlim(-5, 8) +
ylim(-5, 5)
coembed_cells
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
) +
xlim(-5, 8) +
ylim(-5, 5)
coembed_cells
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
)
coembed_cells
coembed = merge(x = sorted, y = unsorted)
coembed = ScaleData(coembed, features = genes.use, do.scale = FALSE)
coembed = RunPCA(coembed, features = genes.use, verbose = FALSE)
coembed = RunUMAP(coembed, dims = 1:5)
cols = c("cluster 0 (unsorted)" = "#fc9272", "cluster 1 (unsorted)" = "#9ecae1",
"sorted clusters" = "#31a354")
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
)
coembed_cells
unsorted = readRDS("../../results/Seurat/unsorted_mousebrain/res0.1/outputs/Seurat_object.Rds")
sorted = readRDS("../../results/Seurat/GFP_sorted_mousebrain/res0.8/outputs/Seurat_object.Rds")
DefaultAssay(sorted) = "GA"
DefaultAssay(unsorted) = "GA"
sorted@meta.data$data_type = "sorted G4 scCnT"
sorted@meta.data = sorted@meta.data %>%
mutate(custom_col = "sorted clusters")
unsorted@meta.data$data_type = "unsorted G4 scCnT"
unsorted@meta.data = unsorted@meta.data %>% mutate(
seurat_clusters =
case_when(
seurat_clusters == "0" ~ "cluster 0 (unsorted)",
seurat_clusters == "1" ~ "cluster 1 (unsorted)"
)
) %>%
mutate(custom_col = seurat_clusters)
unsorted = FindVariableFeatures(unsorted, selection.method = "vst", nfeatures = 2000)
genes.use = VariableFeatures(unsorted)
coembed = merge(x = sorted, y = unsorted)
coembed = ScaleData(coembed, features = genes.use, do.scale = FALSE)
coembed = RunPCA(coembed, features = genes.use, verbose = FALSE)
coembed = RunUMAP(coembed, dims = 1:5)
cols = c("cluster 0 (unsorted)" = "#fc9272", "cluster 1 (unsorted)" = "#9ecae1",
"sorted clusters" = "#31a354")
coembed_cells = DimPlot(
coembed,
reduction = "umap",
group.by = "custom_col",
pt.size = 1,
label = FALSE,
label.size = 3,
repel = TRUE,
cols = cols
) +
labs(
title = "sorted + unsorted merged UMAP",
x = "UMAP_1",
y = "UMAP_2",
fill = NULL,
cols = cols
)
coembed_cells
ggsave(
glue("{result_folder}merged-sorted_unsorted.pdf"),
plot = coembed_cells,
device = "pdf",
width = 7,
height = 6
)
